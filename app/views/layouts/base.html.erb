<!DOCTYPE html>
<html lang="<%= I18n.locale %>" class="<%= User.current ? "layout-pf layout-pf-fixed" : "login-pf no-js"%>">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title><%= h(yield(:title) || "Foreman") %></title>
    <meta name="description" content="">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' http://wraines-sandbox.rdu.redhat.com:3808 script-src https://cdn.pendo.io 'unsafe-inline' 'unsafe-eval'">

    <%= yield(:meta) %>

    <%= favicon_link_tag "favicon.ico"%>

    <%= stylesheet_link_tag *webpack_asset_paths('bundle', :extension => 'css'), "data-turbolinks-track" => true %>
    <%= stylesheet_link_tag 'application', "data-turbolinks-track" => true %>
    <%= yield(:stylesheets) %>

    <%= csrf_meta_tags %>
    <%= javascript_include_tag *webpack_asset_paths('vendor', :extension => 'js'), "data-turbolinks-track" => true %>
    <%= javascript_include_tag *webpack_asset_paths('bundle', :extension => 'js'), "data-turbolinks-track" => true %>
    <%= javascript_include_tag "locale/#{FastGettext.locale}/app", "data-turbolinks-track" => true %>
    <%= javascript_include_tag 'application', "data-turbolinks-track" => true %>
    <%= webpack_dev_server %>
    <%= yield(:javascripts) %>

    <script type="text/javascript">
      var URL_PREFIX = '<%= request.script_name %>';

      <% if protect_against_forgery? %>
        var AUTH_TOKEN = '<%= form_authenticity_token %>';
      <% else %>
        var AUTH_TOKEN = null
      <% end %>

      <% if SETTINGS[:mark_translated] && !Rails.env.test? %>
        var I18N_MARK = true;
      <% end %>

      <%= yield(:inline_javascripts) %>
    </script>

    <script>
      (function(apiKey){
        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=[];
          v=['initialize','identify','updateOptions','pageLoad'];for(w=0,x=v.length;w<x;++w)(function(m){
            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
          y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
          z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
          visitor: {
            id: '<%= User.current.id if User.current %>'
          },
          account: {}
        });
      })('2b800693-91e9-49f5-7ca5-9c362c8c85e9');
    </script>

    <%= yield(:head) %>
  </head>

  <body>
    <!--[if lte IE 9]>
      <%= _('You are using an unsupported browser.') %>
    <![endif]-->
    <% if User.current %>
      <% cache(TopbarSweeper.fragment_name, :skip_digest => true) do %>
        <%= render "home/topbar" %>
        <%= render "home/navbar" %>
      <% end %>
      <div class="container-fluid container-pf-nav-pf-vertical nav-pf-persistent-secondary">
        <%= yield(:content) %>
      </div>
    <% else %>
      <%= yield(:content) %>
    <% end %>
  </body>
</html>
